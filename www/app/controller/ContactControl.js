/*
 * File: app/controller/ContactControl.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.1.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.ContactControl', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            sendbtn: {
                selector: '#sendbtn',
                xtype: 'Ext.Button'
            }
        },

        control: {
            "sendbtn": {
                tap: 'onsendbtnTap'
            }
        }
    },

    onsendbtnTap: function(button, e, eOpts) {
        console.log('onsendbtnTap');


        if(button.up('formpanel[id=contactform]').down('textfield[id=fullname]').getValue()==="" 
        || button.up('formpanel[id=contactform]').down('textfield[id=businessname]').getValue()===""
        || button.up('formpanel[id=contactform]').down('textfield[id=Category]').getValue()===""
        || button.up('formpanel[id=contactform]').down('textfield[id=Address]').getValue()===""
        || button.up('formpanel[id=contactform]').down('textfield[id=phonenumber]').getValue()===""
        || button.up('formpanel[id=contactform]').down('textfield[id=emailfield]').getValue()===""
        || button.up('formpanel[id=contactform]').down('textfield[id=capacity]').getValue()===""
        ){

            Ext.Msg.show({
                title:'Please fill all fields',
                buttons: Ext.Msg.YES,
                animEl: 'elId'
            }); 

        }
        else{
            var form = button.up('formpanel[id=contactform]');

            form.submit({
                url: 'http://'+localStorage.serverpath+'/Server-side/contactform.php',
                method: 'POST',
                success: function(form, result) {
                    //var jsonoutput = Ext.decode(result);  // json parsing
                    //alert('form submitted successfully!');
                    console.log('form submit success');

                    Ext.Msg.alert('Contact us', 'Your message has been sent');

                },
                failure: function(form, result) {
                    //var jsonoutput = Ext.decode(result);  // json parsing
                    console.log('form submit failed, result:'+result);
                    //alert('form submitted failed!');
                    Ext.Msg.alert('Contact us', 'Your message has not been sent. please try again');
                }
            });

        }
    }

});